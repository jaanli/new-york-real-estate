var Ft=Object.defineProperty;var r=(e,t)=>Ft(e,"name",{value:t,configurable:!0});var B,Y;import{FileAttachments as Rt,Library as Ut}from"./stdlib.js";var zt=Object.defineProperty,Bt=r((e,t)=>zt(e,"name",{value:t,configurable:!0}),"c$7");function A(e,t,n){n=n||{};var i=e.ownerDocument,l=i.defaultView.CustomEvent;typeof l=="function"?l=new l(t,{detail:n}):(l=i.createEvent("Event"),l.initEvent(t,!1,!1),l.detail=n),e.dispatchEvent(l)}r(A,"o$7"),Bt(A,"dispatch");var Yt=Object.defineProperty,be=r((e,t)=>Yt(e,"name",{value:t,configurable:!0}),"r$7");function ee(e){return Array.isArray(e)||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}r(ee,"isarray"),be(ee,"isarray");function te(e){return e===(e|0)+""}r(te,"isindex"),be(te,"isindex");var Vt=Object.defineProperty,Ht=r((e,t)=>Vt(e,"name",{value:t,configurable:!0}),"n$7");function g(e){const t=document.createElement("span");return t.className="observablehq--cellname",t.textContent=`${e} = `,t}r(g,"c$6"),Ht(g,"inspectName");var Gt=Object.defineProperty,Jt=r((e,t)=>Gt(e,"name",{value:t,configurable:!0}),"t$6");const Kt=Symbol.prototype.toString;function P(e){return Kt.call(e)}r(P,"e$4"),Jt(P,"formatSymbol");var Xt=Object.defineProperty,ne=r((e,t)=>Xt(e,"name",{value:t,configurable:!0}),"n$5");const{getOwnPropertySymbols:Zt,prototype:{hasOwnProperty:Qt}}=Object,{toStringTag:Wt}=Symbol,ve={},I=Zt;function L(e,t){return Qt.call(e,t)}r(L,"isown"),ne(L,"isown");function V(e){return e[Wt]||e.constructor&&e.constructor.name||"Object"}r(V,"tagof"),ne(V,"tagof");function _(e,t){try{const n=e[t];return n&&n.constructor,n}catch{return ve}}r(_,"valueof"),ne(_,"valueof");var en=Object.defineProperty,tn=r((e,t)=>en(e,"name",{value:t,configurable:!0}),"i$4");const nn=[{symbol:"@@__IMMUTABLE_INDEXED__@@",name:"Indexed",modifier:!0},{symbol:"@@__IMMUTABLE_KEYED__@@",name:"Keyed",modifier:!0},{symbol:"@@__IMMUTABLE_LIST__@@",name:"List",arrayish:!0},{symbol:"@@__IMMUTABLE_MAP__@@",name:"Map"},{symbol:"@@__IMMUTABLE_ORDERED__@@",name:"Ordered",modifier:!0,prefix:!0},{symbol:"@@__IMMUTABLE_RECORD__@@",name:"Record"},{symbol:"@@__IMMUTABLE_SET__@@",name:"Set",arrayish:!0,setish:!0},{symbol:"@@__IMMUTABLE_STACK__@@",name:"Stack",arrayish:!0}];function re(e){try{let t=nn.filter(({symbol:a})=>e[a]===!0);if(!t.length)return;const n=t.find(a=>!a.modifier),i=n.name==="Map"&&t.find(a=>a.modifier&&a.prefix),l=t.some(a=>a.arrayish),o=t.some(a=>a.setish);return{name:`${i?i.name:""}${n.name}`,symbols:t,arrayish:l&&!o,setish:o}}catch{return null}}r(re,"immutableName"),tn(re,"immutableName");var rn=Object.defineProperty,b=r((e,t)=>rn(e,"name",{value:t,configurable:!0}),"i$3");const{getPrototypeOf:ie,getOwnPropertyDescriptors:an}=Object,ye=ie({});function ae(e,t,n,i){let l=ee(e),o,a,s,u;e instanceof Map?e instanceof e.constructor?(o=`Map(${e.size})`,a=ge):(o="Map()",a=j):e instanceof Set?e instanceof e.constructor?(o=`Set(${e.size})`,a=$e):(o="Set()",a=j):l?(o=`${e.constructor.name}(${e.length})`,a=Ce):(u=re(e))?(o=`Immutable.${u.name}${u.name==="Record"?"":`(${e.size})`}`,l=u.arrayish,a=u.arrayish?Ee:u.setish?we:Se):i?(o=V(e),a=xe):(o=V(e),a=j);const c=document.createElement("span");c.className="observablehq--expanded",n&&c.appendChild(g(n));const p=c.appendChild(document.createElement("a"));p.innerHTML=`<svg width=8 height=8 class='observablehq--caret'>
    <path d='M4 7L0 1h8z' fill='currentColor' />
  </svg>`,p.appendChild(document.createTextNode(`${o}${l?" [":" {"}`)),p.addEventListener("mouseup",function(d){d.stopPropagation(),D(c,H(e,null,n,i))}),a=a(e);for(let d=0;!(s=a.next()).done&&d<20;++d)c.appendChild(s.value);if(!s.done){const d=c.appendChild(document.createElement("a"));d.className="observablehq--field",d.style.display="block",d.appendChild(document.createTextNode("  \u2026 more")),d.addEventListener("mouseup",function(S){S.stopPropagation(),c.insertBefore(s.value,c.lastChild.previousSibling);for(let O=0;!(s=a.next()).done&&O<19;++O)c.insertBefore(s.value,c.lastChild.previousSibling);s.done&&c.removeChild(c.lastChild.previousSibling),A(c,"load")})}return c.appendChild(document.createTextNode(l?"]":"}")),c}r(ae,"F$2"),b(ae,"inspectExpanded");function*ge(e){for(const[t,n]of e)yield Ne(t,n);yield*j(e)}r(ge,"A$3"),b(ge,"iterateMap");function*$e(e){for(const t of e)yield se(t);yield*j(e)}r($e,"B$1"),b($e,"iterateSet");function*we(e){for(const t of e)yield se(t)}r(we,"D$3"),b(we,"iterateImSet");function*Ce(e){for(let t=0,n=e.length;t<n;++t)t in e&&(yield $(t,_(e,t),"observablehq--index"));for(const t in e)!te(t)&&L(e,t)&&(yield $(t,_(e,t),"observablehq--key"));for(const t of I(e))yield $(P(t),_(e,t),"observablehq--symbol")}r(Ce,"H$1"),b(Ce,"iterateArray");function*Ee(e){let t=0;for(const n=e.size;t<n;++t)yield $(t,e.get(t),!0)}r(Ee,"R$1"),b(Ee,"iterateImArray");function*xe(e){for(const n in an(e))yield $(n,_(e,n),"observablehq--key");for(const n of I(e))yield $(P(n),_(e,n),"observablehq--symbol");const t=ie(e);t&&t!==ye&&(yield oe(t))}r(xe,"_"),b(xe,"iterateProto");function*j(e){for(const n in e)L(e,n)&&(yield $(n,_(e,n),"observablehq--key"));for(const n of I(e))yield $(P(n),_(e,n),"observablehq--symbol");const t=ie(e);t&&t!==ye&&(yield oe(t))}r(j,"h$3"),b(j,"iterateObject");function*Se(e){for(const[t,n]of e)yield $(t,n,"observablehq--key")}r(Se,"G$1"),b(Se,"iterateImObject");function oe(e){const t=document.createElement("div"),n=t.appendChild(document.createElement("span"));return t.className="observablehq--field",n.className="observablehq--prototype-key",n.textContent="  <prototype>",t.appendChild(document.createTextNode(": ")),t.appendChild(h(e,void 0,void 0,void 0,!0)),t}r(oe,"E$1"),b(oe,"formatPrototype");function $(e,t,n){const i=document.createElement("div"),l=i.appendChild(document.createElement("span"));return i.className="observablehq--field",l.className=n,l.textContent=`  ${e}`,i.appendChild(document.createTextNode(": ")),i.appendChild(h(t)),i}r($,"s$2"),b($,"formatField");function Ne(e,t){const n=document.createElement("div");return n.className="observablehq--field",n.appendChild(document.createTextNode("  ")),n.appendChild(h(e)),n.appendChild(document.createTextNode(" => ")),n.appendChild(h(t)),n}r(Ne,"J"),b(Ne,"formatMapField");function se(e){const t=document.createElement("div");return t.className="observablehq--field",t.appendChild(document.createTextNode("  ")),t.appendChild(h(e)),t}r(se,"k$1"),b(se,"formatSetField");var on=Object.defineProperty,v=r((e,t)=>on(e,"name",{value:t,configurable:!0}),"a$2");function le(e){const t=window.getSelection();return t.type==="Range"&&(t.containsNode(e,!0)||t.anchorNode.isSelfOrDescendant(e)||t.focusNode.isSelfOrDescendant(e))}r(le,"$$2"),v(le,"hasSelection");function H(e,t,n,i){let l=ee(e),o,a,s,u;if(e instanceof Map?e instanceof e.constructor?(o=`Map(${e.size})`,a=Oe):(o="Map()",a=q):e instanceof Set?e instanceof e.constructor?(o=`Set(${e.size})`,a=Pe):(o="Set()",a=q):l?(o=`${e.constructor.name}(${e.length})`,a=Me):(u=re(e))?(o=`Immutable.${u.name}${u.name==="Record"?"":`(${e.size})`}`,l=u.arrayish,a=u.arrayish?qe:u.setish?je:Te):(o=V(e),a=q),t){const d=document.createElement("span");return d.className="observablehq--shallow",n&&d.appendChild(g(n)),d.appendChild(document.createTextNode(o)),d.addEventListener("mouseup",function(S){le(d)||(S.stopPropagation(),D(d,H(e)))}),d}const c=document.createElement("span");c.className="observablehq--collapsed",n&&c.appendChild(g(n));const p=c.appendChild(document.createElement("a"));p.innerHTML=`<svg width=8 height=8 class='observablehq--caret'>
    <path d='M7 4L1 8V0z' fill='currentColor' />
  </svg>`,p.appendChild(document.createTextNode(`${o}${l?" [":" {"}`)),c.addEventListener("mouseup",function(d){le(c)||(d.stopPropagation(),D(c,ae(e,null,n,i)))},!0),a=a(e);for(let d=0;!(s=a.next()).done&&d<20;++d)d>0&&c.appendChild(document.createTextNode(", ")),c.appendChild(s.value);return s.done||c.appendChild(document.createTextNode(", \u2026")),c.appendChild(document.createTextNode(l?"]":"}")),c}r(H,"q$1"),v(H,"inspectCollapsed");function*Oe(e){for(const[t,n]of e)yield Ae(t,n);yield*q(e)}r(Oe,"D$2"),v(Oe,"iterateMap");function*Pe(e){for(const t of e)yield h(t,!0);yield*q(e)}r(Pe,"F$1"),v(Pe,"iterateSet");function*je(e){for(const t of e)yield h(t,!0)}r(je,"I$2"),v(je,"iterateImSet");function*qe(e){let t=-1,n=0;for(const i=e.size;n<i;++n)n>t+1&&(yield k(n-t-1)),yield h(e.get(n),!0),t=n;n>t+1&&(yield k(n-t-1))}r(qe,"L$2"),v(qe,"iterateImArray");function*Me(e){let t=-1,n=0;for(const i=e.length;n<i;++n)n in e&&(n>t+1&&(yield k(n-t-1)),yield h(_(e,n),!0),t=n);n>t+1&&(yield k(n-t-1));for(const i in e)!te(i)&&L(e,i)&&(yield M(i,_(e,i),"observablehq--key"));for(const i of I(e))yield M(P(i),_(e,i),"observablehq--symbol")}r(Me,"O$3"),v(Me,"iterateArray");function*q(e){for(const t in e)L(e,t)&&(yield M(t,_(e,t),"observablehq--key"));for(const t of I(e))yield M(P(t),_(e,t),"observablehq--symbol")}r(q,"u$2"),v(q,"iterateObject");function*Te(e){for(const[t,n]of e)yield M(t,n,"observablehq--key")}r(Te,"A$2"),v(Te,"iterateImObject");function k(e){const t=document.createElement("span");return t.className="observablehq--empty",t.textContent=e===1?"empty":`empty \xD7 ${e}`,t}r(k,"h$2"),v(k,"formatEmpty");function M(e,t,n){const i=document.createDocumentFragment(),l=i.appendChild(document.createElement("span"));return l.className=n,l.textContent=e,i.appendChild(document.createTextNode(": ")),i.appendChild(h(t,!0)),i}r(M,"m$1"),v(M,"formatField");function Ae(e,t){const n=document.createDocumentFragment();return n.appendChild(h(e,!0)),n.appendChild(document.createTextNode(" => ")),n.appendChild(h(t,!0)),n}r(Ae,"P$1"),v(Ae,"formatMapField");var sn=Object.defineProperty,ce=r((e,t)=>sn(e,"name",{value:t,configurable:!0}),"i$2");function Ie(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(e))return typeof t=="function"?t(e):t;const n=e.getUTCHours(),i=e.getUTCMinutes(),l=e.getUTCSeconds(),o=e.getUTCMilliseconds();return`${Le(e.getUTCFullYear())}-${w(e.getUTCMonth()+1,2)}-${w(e.getUTCDate(),2)}${n||i||l||o?`T${w(n,2)}:${w(i,2)}${l||o?`:${w(l,2)}${o?`.${w(o,3)}`:""}`:""}Z`:""}`}r(Ie,"c$4"),ce(Ie,"format");function Le(e){return e<0?`-${w(-e,6)}`:e>9999?`+${w(e,6)}`:w(e,4)}r(Le,"f$5"),ce(Le,"formatYear");function w(e,t){return`${e}`.padStart(t,"0")}r(w,"t$5"),ce(w,"pad");var ln=Object.defineProperty,cn=r((e,t)=>ln(e,"name",{value:t,configurable:!0}),"r$5");function ke(e){return Ie(e,"Invalid Date")}r(ke,"f$4"),cn(ke,"formatDate");var un=Object.defineProperty,dn=r((e,t)=>un(e,"name",{value:t,configurable:!0}),"t$4"),fn=Error.prototype.toString;function De(e){return e.stack||fn.call(e)}r(De,"e$2"),dn(De,"formatError");var pn=Object.defineProperty,mn=r((e,t)=>pn(e,"name",{value:t,configurable:!0}),"r$4"),hn=RegExp.prototype.toString;function Fe(e){return hn.call(e)}r(Fe,"g$2"),mn(Fe,"formatRegExp");var _n=Object.defineProperty,G=r((e,t)=>_n(e,"name",{value:t,configurable:!0}),"s$1");const ue=20;function Re(e,t,n,i){if(t===!1){if(fe(e,/["\n]/g)<=fe(e,/`|\${/g)){const c=document.createElement("span");i&&c.appendChild(g(i));const p=c.appendChild(document.createElement("span"));return p.className="observablehq--string",p.textContent=JSON.stringify(e),c}const a=e.split(`
`);if(a.length>ue&&!n){const c=document.createElement("div");i&&c.appendChild(g(i));const p=c.appendChild(document.createElement("span"));p.className="observablehq--string",p.textContent="`"+de(a.slice(0,ue).join(`
`));const d=c.appendChild(document.createElement("span")),S=a.length-ue;return d.textContent=`Show ${S} truncated line${S>1?"s":""}`,d.className="observablehq--string-expand",d.addEventListener("mouseup",function(O){O.stopPropagation(),D(c,h(e,t,!0,i))}),c}const s=document.createElement("span");i&&s.appendChild(g(i));const u=s.appendChild(document.createElement("span"));return u.className=`observablehq--string${n?" observablehq--expanded":""}`,u.textContent="`"+de(e)+"`",s}const l=document.createElement("span");i&&l.appendChild(g(i));const o=l.appendChild(document.createElement("span"));return o.className="observablehq--string",o.textContent=JSON.stringify(e.length>100?`${e.slice(0,50)}\u2026${e.slice(-49)}`:e),l}r(Re,"g$1"),G(Re,"formatString");function de(e){return e.replace(/[\\`\x00-\x09\x0b-\x19]|\${/g,Ue)}r(de,"h$1"),G(de,"templatify");function Ue(e){var t=e.charCodeAt(0);switch(t){case 8:return"\\b";case 9:return"\\t";case 11:return"\\v";case 12:return"\\f";case 13:return"\\r"}return t<16?"\\x0"+t.toString(16):t<32?"\\x"+t.toString(16):"\\"+e}r(Ue,"$$1"),G(Ue,"templatifyChar");function fe(e,t){for(var n=0;t.exec(e);)++n;return n}r(fe,"C$1"),G(fe,"count");var bn=Object.defineProperty,ze=r((e,t)=>bn(e,"name",{value:t,configurable:!0}),"a"),vn=Function.prototype.toString,yn={prefix:"async \u0192"},gn={prefix:"async \u0192*"},Be={prefix:"class"},$n={prefix:"\u0192"},wn={prefix:"\u0192*"};function Ye(e,t){var n,i,l=vn.call(e);switch(e.constructor&&e.constructor.name){case"AsyncFunction":n=yn;break;case"AsyncGeneratorFunction":n=gn;break;case"GeneratorFunction":n=wn;break;default:n=/^class\b/.test(l)?Be:$n;break}return n===Be?T(n,"",t):(i=/^(?:async\s*)?(\w+)\s*=>/.exec(l))?T(n,"("+i[1]+")",t):(i=/^(?:async\s*)?\(\s*(\w+(?:\s*,\s*\w+)*)?\s*\)/.exec(l))?T(n,i[1]?"("+i[1].replace(/\s*,\s*/g,", ")+")":"()",t):(i=/^(?:async\s*)?function(?:\s*\*)?(?:\s*\w+)?\s*\(\s*(\w+(?:\s*,\s*\w+)*)?\s*\)/.exec(l))?T(n,i[1]?"("+i[1].replace(/\s*,\s*/g,", ")+")":"()",t):T(n,"(\u2026)",t)}r(Ye,"y$1"),ze(Ye,"inspectFunction");function T(e,t,n){var i=document.createElement("span");i.className="observablehq--function",n&&i.appendChild(g(n));var l=i.appendChild(document.createElement("span"));return l.className="observablehq--keyword",l.textContent=e.prefix,i.appendChild(document.createTextNode(t)),i}r(T,"c$3"),ze(T,"formatFunction");var Cn=Object.defineProperty,Ve=r((e,t)=>Cn(e,"name",{value:t,configurable:!0}),"c$2");const{prototype:{toString:En}}=Object;function h(e,t,n,i,l){let o=typeof e;switch(o){case"boolean":case"undefined":{e+="";break}case"number":{e=e===0&&1/e<0?"-0":e+"";break}case"bigint":{e=e+"n";break}case"symbol":{e=P(e);break}case"function":return Ye(e,i);case"string":return Re(e,t,n,i);default:{if(e===null){o=null,e="null";break}if(e instanceof Date){o="date",e=ke(e);break}if(e===ve){o="forbidden",e="[forbidden]";break}switch(En.call(e)){case"[object RegExp]":{o="regexp",e=Fe(e);break}case"[object Error]":case"[object DOMException]":{o="error",e=De(e);break}default:return(n?ae:H)(e,t,i,l)}break}}const a=document.createElement("span");i&&a.appendChild(g(i));const s=a.appendChild(document.createElement("span"));return s.className=`observablehq--${o}`,s.textContent=e,a}r(h,"inspect"),Ve(h,"inspect");function D(e,t){e.classList.contains("observablehq--inspect")&&t.classList.add("observablehq--inspect"),e.parentNode.replaceChild(t,e),A(t,"load")}r(D,"replace"),Ve(D,"replace");var xn=Object.defineProperty,He=r((e,t)=>xn(e,"name",{value:t,configurable:!0}),"d$2");const Sn=/\s+\(\d+:\d+\)$/m,Ge=(B=class{constructor(t){if(!t)throw new Error("invalid node");this._node=t,t.classList.add("observablehq")}pending(){const{_node:t}=this;t.classList.remove("observablehq--error"),t.classList.add("observablehq--running")}fulfilled(t,n){const{_node:i}=this;if((!Je(t)||t.parentNode&&t.parentNode!==i)&&(t=h(t,!1,i.firstChild&&i.firstChild.classList&&i.firstChild.classList.contains("observablehq--expanded"),n),t.classList.add("observablehq--inspect")),i.classList.remove("observablehq--running","observablehq--error"),i.firstChild!==t)if(i.firstChild){for(;i.lastChild!==i.firstChild;)i.removeChild(i.lastChild);i.replaceChild(t,i.firstChild)}else i.appendChild(t);A(i,"update")}rejected(t,n){const{_node:i}=this;for(i.classList.remove("observablehq--running"),i.classList.add("observablehq--error");i.lastChild;)i.removeChild(i.lastChild);var l=document.createElement("div");l.className="observablehq--inspect",n&&l.appendChild(g(n)),l.appendChild(document.createTextNode((t+"").replace(Sn,""))),i.appendChild(l),A(i,"error",{error:t})}},r(B,"n"),B);He(Ge,"Inspector");let pe=Ge;pe.into=function(e){if(typeof e=="string"&&(e=document.querySelector(e),e==null))throw new Error("container not found");return function(){return new pe(e.appendChild(document.createElement("div")))}};function Je(e){return(e instanceof Element||e instanceof Text)&&e instanceof e.constructor}r(Je,"f$1"),He(Je,"isnode");var Nn=Object.defineProperty,On=r((e,t)=>Nn(e,"name",{value:t,configurable:!0}),"e$1");const Ke=(Y=class extends Error{constructor(t,n){super(t),this.input=n}},r(Y,"s"),Y);On(Ke,"RuntimeError");let C=Ke;C.prototype.name="RuntimeError";var Pn=Object.defineProperty,jn=r((e,t)=>Pn(e,"name",{value:t,configurable:!0}),"t$3");function Xe(e){return e&&typeof e.next=="function"&&typeof e.return=="function"}r(Xe,"generatorish"),jn(Xe,"generatorish");var qn=Object.defineProperty,Mn=r((e,t)=>qn(e,"name",{value:t,configurable:!0}),"t$2");function J(e){return()=>e}r(J,"constant"),Mn(J,"constant");var Tn=Object.defineProperty,An=r((e,t)=>Tn(e,"name",{value:t,configurable:!0}),"n$1");function F(e){return e}r(F,"identity"),An(F,"identity");var In=Object.defineProperty,Ln=r((e,t)=>In(e,"name",{value:t,configurable:!0}),"t$1");function Ze(e){return()=>{throw e}}r(Ze,"rethrow"),Ln(Ze,"rethrow");const kn=Array.prototype,Dn=kn.map;var Fn=Object.defineProperty,Rn=r((e,t)=>Fn(e,"name",{value:t,configurable:!0}),"o$1");function E(){}r(E,"noop"),Rn(E,"noop");var Un=Object.defineProperty,m=r((e,t)=>Un(e,"name",{value:t,configurable:!0}),"r");const me=1,R=2,K=3,U=Symbol("no-observer");function N(e,t,n,i){n||(n=U),Object.defineProperties(this,{_observer:{value:n,writable:!0},_definition:{value:X,writable:!0},_duplicate:{value:void 0,writable:!0},_duplicates:{value:void 0,writable:!0},_indegree:{value:NaN,writable:!0},_inputs:{value:[],writable:!0},_invalidate:{value:E,writable:!0},_module:{value:t},_name:{value:null,writable:!0},_outputs:{value:new Set,writable:!0},_promise:{value:Promise.resolve(void 0),writable:!0},_reachable:{value:n!==U,writable:!0},_rejector:{value:tt(this)},_shadow:{value:Qe(t,i)},_type:{value:e},_value:{value:void 0,writable:!0},_version:{value:0,writable:!0}})}r(N,"Variable"),m(N,"Variable"),Object.defineProperties(N.prototype,{_pending:{value:ot,writable:!0,configurable:!0},_fulfilled:{value:st,writable:!0,configurable:!0},_rejected:{value:lt,writable:!0,configurable:!0},_resolve:{value:rt,writable:!0,configurable:!0},define:{value:nt,writable:!0,configurable:!0},delete:{value:at,writable:!0,configurable:!0},import:{value:it,writable:!0,configurable:!0}});function Qe(e,t){return t?.shadow?new Map(Object.entries(t.shadow).map(([n,i])=>[n,new N(R,e).define([],i)])):null}r(Qe,"w$1"),m(Qe,"initShadow");function We(e){e._module._runtime._dirty.add(e),e._outputs.add(this)}r(We,"m"),m(We,"variable_attach");function et(e){e._module._runtime._dirty.add(e),e._outputs.delete(this)}r(et,"g"),m(et,"variable_detach");function X(){throw X}r(X,"d$1"),m(X,"variable_undefined");function x(){throw x}r(x,"variable_stale"),m(x,"variable_stale");function tt(e){return t=>{throw t===x?t:t===X?new C(`${e._name} is not defined`,e._name):t instanceof Error&&t.message?new C(t.message,e._name):new C(`${e._name} could not be resolved`,e._name)}}r(tt,"y"),m(tt,"variable_rejector");function he(e){return()=>{throw new C(`${e} is defined more than once`)}}r(he,"f"),m(he,"variable_duplicate");function nt(e,t,n){switch(arguments.length){case 1:{n=e,e=t=null;break}case 2:{n=t,typeof e=="string"?t=null:(t=e,e=null);break}}return Z.call(this,e==null?null:String(e),t==null?[]:Dn.call(t,this._resolve,this),typeof n=="function"?n:J(n))}r(nt,"E"),m(nt,"variable_define");function rt(e){return this._shadow?.get(e)??this._module._resolve(e)}r(rt,"x$2"),m(rt,"variable_resolve");function Z(e,t,n){const i=this._module._scope,l=this._module._runtime;if(this._inputs.forEach(et,this),t.forEach(We,this),this._inputs=t,this._definition=n,this._value=void 0,n===E?l._variables.delete(this):l._variables.add(this),e!==this._name||i.get(e)!==this){let o,a;if(this._name)if(this._outputs.size)i.delete(this._name),a=this._module._resolve(this._name),a._outputs=this._outputs,this._outputs=new Set,a._outputs.forEach(function(s){s._inputs[s._inputs.indexOf(this)]=a},this),a._outputs.forEach(l._updates.add,l._updates),l._dirty.add(a).add(this),i.set(this._name,a);else if((a=i.get(this._name))===this)i.delete(this._name);else if(a._type===K)a._duplicates.delete(this),this._duplicate=void 0,a._duplicates.size===1&&(a=a._duplicates.keys().next().value,o=i.get(this._name),a._outputs=o._outputs,o._outputs=new Set,a._outputs.forEach(function(s){s._inputs[s._inputs.indexOf(o)]=a}),a._definition=a._duplicate,a._duplicate=void 0,l._dirty.add(o).add(a),l._updates.add(a),i.set(this._name,a));else throw new Error;if(this._outputs.size)throw new Error;e&&((a=i.get(e))?a._type===K?(this._definition=he(e),this._duplicate=n,a._duplicates.add(this)):a._type===R?(this._outputs=a._outputs,a._outputs=new Set,this._outputs.forEach(function(s){s._inputs[s._inputs.indexOf(a)]=this},this),l._dirty.add(a).add(this),i.set(e,this)):(a._duplicate=a._definition,this._duplicate=n,o=new N(K,this._module),o._name=e,o._definition=this._definition=a._definition=he(e),o._outputs=a._outputs,a._outputs=new Set,o._outputs.forEach(function(s){s._inputs[s._inputs.indexOf(a)]=o}),o._duplicates=new Set([this,a]),l._dirty.add(a).add(o),l._updates.add(a).add(o),i.set(e,o)):i.set(e,this)),this._name=e}return this._version>0&&++this._version,l._updates.add(this),l._compute(),this}r(Z,"h"),m(Z,"variable_defineImpl");function it(e,t,n){return arguments.length<3&&(n=t,t=e),Z.call(this,String(t),[n._resolve(String(e))],F)}r(it,"S$1"),m(it,"variable_import");function at(){return Z.call(this,null,[],E)}r(at,"j$1"),m(at,"variable_delete");function ot(){this._observer.pending&&this._observer.pending()}r(ot,"O$2"),m(ot,"variable_pending");function st(e){this._observer.fulfilled&&this._observer.fulfilled(e,this._name)}r(st,"P"),m(st,"variable_fulfilled");function lt(e){this._observer.rejected&&this._observer.rejected(e,this._name)}r(lt,"I$1"),m(lt,"variable_rejected");var zn=Object.defineProperty,y=r((e,t)=>zn(e,"name",{value:t,configurable:!0}),"n");const ct=Symbol("variable"),ut=Symbol("invalidation"),dt=Symbol("visibility");function z(e,t=[]){Object.defineProperties(this,{_runtime:{value:e},_scope:{value:new Map},_builtins:{value:new Map([["@variable",ct],["invalidation",ut],["visibility",dt],...t])},_source:{value:null,writable:!0}})}r(z,"Module"),y(z,"Module"),Object.defineProperties(z.prototype,{_resolve:{value:vt,writable:!0,configurable:!0},redefine:{value:ft,writable:!0,configurable:!0},define:{value:pt,writable:!0,configurable:!0},derive:{value:bt,writable:!0,configurable:!0},import:{value:mt,writable:!0,configurable:!0},value:{value:_t,writable:!0,configurable:!0},variable:{value:ht,writable:!0,configurable:!0},builtin:{value:yt,writable:!0,configurable:!0}});function ft(e){const t=this._scope.get(e);if(!t)throw new C(`${e} is not defined`);if(t._type===K)throw new C(`${e} is defined more than once`);return t.define.apply(t,arguments)}r(ft,"j"),y(ft,"module_redefine");function pt(){const e=new N(me,this);return e.define.apply(e,arguments)}r(pt,"x$1"),y(pt,"module_define");function mt(){const e=new N(me,this);return e.import.apply(e,arguments)}r(mt,"S"),y(mt,"module_import");function ht(e,t){return new N(me,this,e,t)}r(ht,"L$1"),y(ht,"module_variable");async function _t(e){let t=this._scope.get(e);if(!t)throw new C(`${e} is not defined`);if(t._observer===U){t=this.variable(!0).define([e],F);try{return await Q(this._runtime,t)}finally{t.delete()}}else return Q(this._runtime,t)}r(_t,"O$1"),y(_t,"module_value");async function Q(e,t){await e._compute();try{return await t._promise}catch(n){if(n===x)return Q(e,t);throw n}}r(Q,"p"),y(Q,"module_revalue");function bt(e,t){const n=new Map,i=new Set,l=[];function o(s){let u=n.get(s);return u||(u=new z(s._runtime,s._builtins),u._source=s,n.set(s,u),l.push([u,s]),i.add(s),u)}r(o,"v"),y(o,"alias");const a=o(this);for(const s of e){const{alias:u,name:c}=typeof s=="object"?s:{name:s};a.import(c,u??c,t)}for(const s of i)for(const[u,c]of s._scope)if(c._definition===F){if(s===this&&a._scope.has(u))continue;const p=c._inputs[0]._module;p._source&&o(p)}for(const[s,u]of l)for(const[c,p]of u._scope){const d=s._scope.get(c);if(!(d&&d._type!==R))if(p._definition===F){const S=p._inputs[0],O=S._module;s.import(S._name,c,n.get(O)||O)}else s.define(c,p._inputs.map(gt),p._definition)}return a}r(bt,"V$1"),y(bt,"module_derive");function vt(e){let t=this._scope.get(e),n;if(!t)if(t=new N(R,this),this._builtins.has(e))t.define(e,J(this._builtins.get(e)));else if(this._runtime._builtin._scope.has(e))t.import(e,this._runtime._builtin);else{try{n=this._runtime._global(e)}catch(i){return t.define(e,Ze(i))}n===void 0?this._scope.set(t._name=e,t):t.define(e,J(n))}return t}r(vt,"Y$1"),y(vt,"module_resolve");function yt(e,t){this._builtins.set(e,t)}r(yt,"$"),y(yt,"module_builtin");function gt(e){return e._name}r(gt,"A$1"),y(gt,"variable_name");var Bn=Object.defineProperty,f=r((e,t)=>Bn(e,"name",{value:t,configurable:!0}),"o");const Yn=typeof requestAnimationFrame=="function"?requestAnimationFrame:typeof setImmediate=="function"?setImmediate:e=>setTimeout(e,0);function _e(e=new Ut,t=Dt){const n=this.module();if(Object.defineProperties(this,{_dirty:{value:new Set},_updates:{value:new Set},_precomputes:{value:[],writable:!0},_computing:{value:null,writable:!0},_init:{value:null,writable:!0},_modules:{value:new Map},_variables:{value:new Set},_disposed:{value:!1,writable:!0},_builtin:{value:n},_global:{value:t}}),e)for(const i in e)new N(R,n).define(i,[],e[i])}r(_e,"Runtime"),f(_e,"Runtime"),Object.defineProperties(_e.prototype,{_precompute:{value:Ct,writable:!0,configurable:!0},_compute:{value:Et,writable:!0,configurable:!0},_computeSoon:{value:xt,writable:!0,configurable:!0},_computeNow:{value:St,writable:!0,configurable:!0},dispose:{value:$t,writable:!0,configurable:!0},module:{value:wt,writable:!0,configurable:!0},fileAttachments:{value:Rt,writable:!0,configurable:!0}});function $t(){this._computing=Promise.resolve(),this._disposed=!0,this._variables.forEach(e=>{e._invalidate(),e._version=NaN})}r($t,"k"),f($t,"runtime_dispose");function wt(e,t=E){let n;if(e===void 0)return(n=this._init)?(this._init=null,n):new z(this);if(n=this._modules.get(e),n)return n;this._init=n=new z(this),this._modules.set(e,n);try{e(this,t)}finally{this._init=null}return n}r(wt,"q"),f(wt,"runtime_module");function Ct(e){this._precomputes.push(e),this._compute()}r(Ct,"A"),f(Ct,"runtime_precompute");function Et(){return this._computing||(this._computing=this._computeSoon())}r(Et,"O"),f(Et,"runtime_compute");function xt(){return new Promise(Yn).then(()=>this._disposed?void 0:this._computeNow())}r(xt,"T"),f(xt,"runtime_computeSoon");async function St(){let e=[],t,n,i=this._precomputes;if(i.length){this._precomputes=[];for(const o of i)o();await Nt(3)}t=new Set(this._dirty),t.forEach(function(o){o._inputs.forEach(t.add,t);const a=kt(o);a>o._reachable?this._updates.add(o):a<o._reachable&&o._invalidate(),o._reachable=a},this),t=new Set(this._updates),t.forEach(function(o){o._reachable?(o._indegree=0,o._outputs.forEach(t.add,t)):(o._indegree=NaN,t.delete(o))}),this._computing=null,this._updates.clear(),this._dirty.clear(),t.forEach(function(o){o._outputs.forEach(Pt)});do{for(t.forEach(function(o){o._indegree===0&&e.push(o)});n=e.pop();)Tt(n),n._outputs.forEach(l),t.delete(n);t.forEach(function(o){Ot(o)&&(It(o,new C("circular definition")),o._outputs.forEach(jt),t.delete(o))})}while(t.size);function l(o){--o._indegree===0&&e.push(o)}r(l,"f"),f(l,"postqueue")}r(St,"F"),f(St,"runtime_computeNow");function Nt(e=0){let t=Promise.resolve();for(let n=0;n<e;++n)t=t.then(()=>{});return t}r(Nt,"M"),f(Nt,"runtime_defer");function Ot(e){const t=new Set(e._inputs);for(const n of t){if(n===e)return!0;n._inputs.forEach(t.add,t)}return!1}r(Ot,"x"),f(Ot,"variable_circular");function Pt(e){++e._indegree}r(Pt,"L"),f(Pt,"variable_increment");function jt(e){--e._indegree}r(jt,"R"),f(jt,"variable_decrement");function qt(e){return e._promise.catch(e._rejector)}r(qt,"V"),f(qt,"variable_value");function W(e){return new Promise(function(t){e._invalidate=t})}r(W,"d"),f(W,"variable_invalidator");function Mt(e,t){let n=typeof IntersectionObserver=="function"&&t._observer&&t._observer._node,i=!n,l=E,o=E,a,s;return n&&(s=new IntersectionObserver(([u])=>(i=u.isIntersecting)&&(a=null,l())),s.observe(n),e.then(()=>(s.disconnect(),s=null,o()))),function(u){return i?Promise.resolve(u):s?(a||(a=new Promise((c,p)=>(l=c,o=p))),a.then(()=>u)):Promise.reject()}}r(Mt,"z"),f(Mt,"variable_intersector");function Tt(e){e._invalidate(),e._invalidate=E,e._pending();const t=e._value,n=++e._version;let i=null;const l=e._promise=(e._inputs.length?Promise.all(e._inputs.map(qt)).then(o):new Promise(s=>s(e._definition.call(t)))).then(a);function o(s){if(e._version!==n)throw x;for(let u=0,c=s.length;u<c;++u)switch(s[u]){case ut:{s[u]=i=W(e);break}case dt:{i||(i=W(e)),s[u]=Mt(i,e);break}case ct:{s[u]=e;break}}return e._definition.apply(t,s)}r(o,"r"),f(o,"define");function a(s){if(e._version!==n)throw x;return Xe(s)?((i||W(e)).then(Lt(s)),At(e,n,s)):s}r(a,"_"),f(a,"generate"),l.then(s=>{e._value=s,e._fulfilled(s)},s=>{s===x||e._version!==n||(e._value=void 0,e._rejected(s))})}r(Tt,"C"),f(Tt,"variable_compute");function At(e,t,n){const i=e._module._runtime;let l;function o(u){return new Promise(c=>c(n.next(l))).then(({done:c,value:p})=>c?void 0:Promise.resolve(p).then(u))}r(o,"r"),f(o,"compute");function a(){const u=o(c=>{if(e._version!==t)throw x;return l=c,s(c,u).then(()=>i._precompute(a)),e._fulfilled(c),c});u.catch(c=>{c===x||e._version!==t||(s(void 0,u),e._rejected(c))})}r(a,"_"),f(a,"recompute");function s(u,c){return e._value=u,e._promise=c,e._outputs.forEach(i._updates.add,i._updates),i._compute()}return r(s,"i"),f(s,"postcompute"),o(u=>{if(e._version!==t)throw x;return l=u,i._precompute(a),u})}r(At,"Y"),f(At,"variable_generate");function It(e,t){e._invalidate(),e._invalidate=E,e._pending(),++e._version,e._indegree=NaN,(e._promise=Promise.reject(t)).catch(E),e._value=void 0,e._rejected(t)}r(It,"B"),f(It,"variable_error");function Lt(e){return function(){e.return()}}r(Lt,"D"),f(Lt,"variable_return");function kt(e){if(e._observer!==U)return!0;const t=new Set(e._outputs);for(const n of t){if(n._observer!==U)return!0;n._outputs.forEach(t.add,t)}return!1}r(kt,"G"),f(kt,"variable_reachable");function Dt(e){return globalThis[e]}r(Dt,"H"),f(Dt,"window_global");export{pe as Inspector,_e as Runtime,C as RuntimeError};
